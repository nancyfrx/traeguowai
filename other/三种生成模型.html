<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹»å¢ƒé€ ç‰© | AI åˆ›ä½œå¼•æ“</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg-primary: #0a0a0f; --bg-secondary: #12121a; --bg-card: rgba(20, 20, 35, 0.8);
            --accent-cyan: #00f5ff; --accent-magenta: #ff00ff; --accent-violet: #8b5cf6;
            --accent-gold: #ffd700; --accent-green: #00ff88; --accent-orange: #ff6b35;
            --text-primary: #ffffff; --text-secondary: #a0a0b0;
            --glass: rgba(255, 255, 255, 0.05); --glass-border: rgba(255, 255, 255, 0.1);
        }
        body { font-family: 'Noto Sans SC', sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; overflow-x: hidden; }
        .bg-animation { position: fixed; inset: 0; z-index: -1; overflow: hidden; }
        .bg-animation::before { content: ''; position: absolute; width: 200%; height: 200%; top: -50%; left: -50%;
            background: radial-gradient(circle at 20% 80%, rgba(0, 245, 255, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(255, 0, 255, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 40% 40%, rgba(139, 92, 246, 0.1) 0%, transparent 40%);
            animation: bgRotate 30s linear infinite; }
        @keyframes bgRotate { to { transform: rotate(360deg); } }
        .particles { position: fixed; inset: 0; z-index: -1; pointer-events: none; }
        .particle { position: absolute; width: 4px; height: 4px; background: var(--accent-cyan); border-radius: 50%; animation: float 15s infinite; opacity: 0.6; }
        .particle:nth-child(odd) { background: var(--accent-magenta); }
        .particle:nth-child(3n) { background: var(--accent-violet); }
        @keyframes float { 0%, 100% { transform: translateY(100vh) scale(0); opacity: 0; } 10%, 90% { opacity: 0.6; } 100% { transform: translateY(-100vh) scale(1); } }
        header { padding: 1.5rem 4rem; display: flex; justify-content: space-between; align-items: center; position: relative; z-index: 10; }
        .logo { font-family: 'Orbitron', sans-serif; font-size: 1.8rem; font-weight: 900; background: linear-gradient(135deg, var(--accent-cyan), var(--accent-magenta)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: 2px; }
        .logo-sub { font-size: 0.7rem; color: var(--text-secondary); letter-spacing: 4px; margin-top: 0.3rem; }
        .mode-tabs { display: flex; gap: 0.5rem; background: var(--glass); padding: 0.4rem; border-radius: 16px; border: 1px solid var(--glass-border); }
        .mode-tab { padding: 0.8rem 1.5rem; border: none; background: transparent; color: var(--text-secondary); font-family: 'Orbitron', sans-serif; font-size: 0.8rem; font-weight: 600; cursor: pointer; border-radius: 12px; transition: all 0.3s; display: flex; align-items: center; gap: 0.5rem; }
        .mode-tab:hover { color: var(--text-primary); }
        .mode-tab.active { background: linear-gradient(135deg, var(--accent-cyan), var(--accent-magenta)); color: var(--bg-primary); }
        .container { max-width: 1500px; margin: 0 auto; padding: 1.5rem 4rem 4rem; position: relative; z-index: 10; }
        .hero { text-align: center; margin-bottom: 2rem; }
        .hero h1 { font-family: 'Orbitron', sans-serif; font-size: 2.8rem; font-weight: 900; margin-bottom: 0.8rem; background: linear-gradient(135deg, #fff 0%, var(--accent-cyan) 50%, var(--accent-magenta) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; animation: titleGlow 3s ease-in-out infinite; }
        @keyframes titleGlow { 0%, 100% { filter: drop-shadow(0 0 20px rgba(0, 245, 255, 0.5)); } 50% { filter: drop-shadow(0 0 40px rgba(255, 0, 255, 0.5)); } }
        .hero p { color: var(--text-secondary); font-size: 1rem; max-width: 600px; margin: 0 auto; }
        .main-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
        .glass-card { background: var(--bg-card); backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 24px; padding: 1.8rem; position: relative; overflow: hidden; }
        .glass-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px; background: linear-gradient(90deg, transparent, var(--accent-cyan), var(--accent-magenta), transparent); }
        .card-title { font-family: 'Orbitron', sans-serif; font-size: 0.9rem; color: var(--accent-cyan); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; letter-spacing: 2px; }
        .card-title::before { content: ''; width: 8px; height: 8px; background: var(--accent-cyan); border-radius: 50%; animation: pulse 2s ease-in-out infinite; }
        .card-title.magenta { color: var(--accent-magenta); }
        .card-title.magenta::before { background: var(--accent-magenta); }
        .card-title.green { color: var(--accent-green); }
        .card-title.green::before { background: var(--accent-green); }
        .card-title.orange { color: var(--accent-orange); }
        .card-title.orange::before { background: var(--accent-orange); }
        @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(1.2); } }
        .model-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.8rem; margin-bottom: 1.2rem; }
        .model-grid.text-models { grid-template-columns: repeat(2, 1fr); }
        .model-grid.video-models { grid-template-columns: repeat(2, 1fr); }
        .model-option { background: var(--glass); border: 2px solid var(--glass-border); border-radius: 14px; padding: 0.9rem; cursor: pointer; transition: all 0.3s; position: relative; }
        .model-option:hover { border-color: var(--accent-cyan); transform: translateY(-2px); }
        .model-option.active { border-color: var(--accent-cyan); background: rgba(0, 245, 255, 0.1); box-shadow: 0 0 30px rgba(0, 245, 255, 0.2); }
        .model-option.active::after { content: 'âœ“'; position: absolute; top: 0.4rem; right: 0.4rem; width: 18px; height: 18px; background: var(--accent-cyan); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.65rem; color: var(--bg-primary); }
        .model-name { font-weight: 700; margin-bottom: 0.2rem; font-size: 0.85rem; }
        .model-desc { font-size: 0.7rem; color: var(--text-secondary); }
        .model-badge { display: inline-block; font-size: 0.6rem; padding: 0.15rem 0.4rem; border-radius: 6px; margin-top: 0.3rem; font-weight: 600; }
        .badge-fast { background: rgba(0, 255, 136, 0.2); color: var(--accent-green); }
        .badge-quality { background: rgba(139, 92, 246, 0.2); color: var(--accent-violet); }
        .badge-creative { background: rgba(255, 0, 255, 0.2); color: var(--accent-magenta); }
        .badge-smart { background: rgba(255, 215, 0, 0.2); color: var(--accent-gold); }
        .badge-video { background: rgba(255, 107, 53, 0.2); color: var(--accent-orange); }
        .badge-free { background: rgba(0, 255, 136, 0.2); color: var(--accent-green); }
        .prompt-section { margin-bottom: 1.2rem; }
        .prompt-textarea { width: 100%; min-height: 100px; background: var(--glass); border: 2px solid var(--glass-border); border-radius: 14px; padding: 1rem; color: var(--text-primary); font-family: inherit; font-size: 0.95rem; resize: vertical; transition: all 0.3s; }
        .prompt-textarea:focus { outline: none; border-color: var(--accent-cyan); box-shadow: 0 0 30px rgba(0, 245, 255, 0.2); }
        .prompt-textarea::placeholder { color: var(--text-secondary); }
        .size-options { display: flex; gap: 0.8rem; margin-bottom: 1.2rem; flex-wrap: wrap; }
        .size-btn { background: var(--glass); border: 2px solid var(--glass-border); border-radius: 10px; padding: 0.6rem 1rem; color: var(--text-primary); cursor: pointer; transition: all 0.3s; font-size: 0.8rem; }
        .size-btn:hover { border-color: var(--accent-magenta); }
        .size-btn.active { border-color: var(--accent-magenta); background: rgba(255, 0, 255, 0.1); box-shadow: 0 0 20px rgba(255, 0, 255, 0.2); }
        .generate-btn { width: 100%; padding: 1rem; font-family: 'Orbitron', sans-serif; font-size: 1rem; font-weight: 700; letter-spacing: 2px; color: var(--bg-primary); background: linear-gradient(135deg, var(--accent-cyan), var(--accent-magenta)); border: none; border-radius: 14px; cursor: pointer; position: relative; overflow: hidden; transition: all 0.3s; }
        .generate-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 40px rgba(0, 245, 255, 0.4); }
        .generate-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .generate-btn.video-btn { background: linear-gradient(135deg, var(--accent-orange), var(--accent-magenta)); }
        .generate-btn.video-btn:hover { box-shadow: 0 10px 40px rgba(255, 107, 53, 0.4); }
        .preview-area { min-height: 380px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .preview-placeholder { text-align: center; color: var(--text-secondary); }
        .preview-placeholder .icon { font-size: 3.5rem; margin-bottom: 1rem; opacity: 0.5; }
        .preview-image { max-width: 100%; max-height: 450px; border-radius: 14px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5); animation: imageReveal 0.5s ease-out; }
        .preview-video { max-width: 100%; max-height: 450px; border-radius: 14px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5); animation: imageReveal 0.5s ease-out; background: #000; }
        @keyframes imageReveal { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .text-output { width: 100%; min-height: 300px; max-height: 500px; overflow-y: auto; background: var(--glass); border: 1px solid var(--glass-border); border-radius: 14px; padding: 1.2rem; font-size: 0.95rem; line-height: 1.8; white-space: pre-wrap; display: none; }
        .text-output.visible { display: block; }
        .text-output .typing-cursor { display: inline-block; width: 2px; height: 1.2em; background: var(--accent-cyan); margin-left: 2px; animation: blink 1s infinite; vertical-align: middle; }
        @keyframes blink { 0%, 50% { opacity: 1; } 51%, 100% { opacity: 0; } }
        .loading-container { display: none; flex-direction: column; align-items: center; gap: 1.5rem; }
        .loading-container.active { display: flex; }
        .cyber-loader { width: 100px; height: 100px; position: relative; }
        .cyber-loader .ring { position: absolute; width: 100%; height: 100%; border: 3px solid transparent; border-radius: 50%; }
        .cyber-loader .ring:nth-child(1) { border-top-color: var(--accent-cyan); animation: spin 1.5s linear infinite; }
        .cyber-loader .ring:nth-child(2) { width: 80%; height: 80%; top: 10%; left: 10%; border-right-color: var(--accent-magenta); animation: spinReverse 1s linear infinite; }
        .cyber-loader .ring:nth-child(3) { width: 60%; height: 60%; top: 20%; left: 20%; border-bottom-color: var(--accent-violet); animation: spin 0.8s linear infinite; }
        .cyber-loader .core { position: absolute; width: 18px; height: 18px; top: 50%; left: 50%; transform: translate(-50%, -50%); background: linear-gradient(135deg, var(--accent-cyan), var(--accent-magenta)); border-radius: 50%; animation: corePulse 1s ease-in-out infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes spinReverse { to { transform: rotate(-360deg); } }
        @keyframes corePulse { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.3); } }
        .loading-text { font-family: 'Orbitron', sans-serif; font-size: 0.85rem; color: var(--accent-cyan); letter-spacing: 3px; animation: textFlicker 2s infinite; }
        @keyframes textFlicker { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .action-buttons { display: none; gap: 0.8rem; margin-top: 1.2rem; width: 100%; justify-content: center; flex-wrap: wrap; }
        .action-buttons.visible { display: flex; }
        .action-btn { padding: 0.7rem 1.2rem; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem; }
        .download-btn { background: linear-gradient(135deg, var(--accent-cyan), #00c4cc); border: none; color: var(--bg-primary); }
        .download-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(0, 245, 255, 0.4); }
        .copy-btn { background: linear-gradient(135deg, var(--accent-green), #00cc6a); border: none; color: var(--bg-primary); }
        .copy-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(0, 255, 136, 0.4); }
        .share-btn { background: transparent; border: 2px solid var(--accent-magenta); color: var(--accent-magenta); }
        .share-btn:hover { background: rgba(255, 0, 255, 0.1); transform: translateY(-2px); }
        .video-download-btn { background: linear-gradient(135deg, var(--accent-orange), #ff8c5a); border: none; color: var(--bg-primary); }
        .video-download-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(255, 107, 53, 0.4); }
        .history-section { margin-top: 2rem; }
        .history-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 1rem; margin-top: 1rem; }
        .history-item { position: relative; border-radius: 12px; overflow: hidden; aspect-ratio: 1; cursor: pointer; transition: all 0.3s; }
        .history-item:hover { transform: scale(1.05); z-index: 10; }
        .history-item img, .history-item video { width: 100%; height: 100%; object-fit: cover; }
        .history-item .overlay { position: absolute; inset: 0; background: linear-gradient(to top, rgba(0, 0, 0, 0.8), transparent); opacity: 0; transition: opacity 0.3s; display: flex; align-items: flex-end; padding: 0.8rem; }
        .history-item:hover .overlay { opacity: 1; }
        .history-item .prompt-preview { font-size: 0.7rem; color: var(--text-primary); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .history-item .video-badge { position: absolute; top: 0.5rem; right: 0.5rem; background: var(--accent-orange); color: #fff; padding: 0.2rem 0.5rem; border-radius: 6px; font-size: 0.6rem; font-weight: 600; }
        .text-history-item { background: var(--glass); border: 1px solid var(--glass-border); border-radius: 12px; padding: 1rem; cursor: pointer; transition: all 0.3s; }
        .text-history-item:hover { border-color: var(--accent-cyan); transform: translateY(-2px); }
        .text-history-prompt { font-size: 0.75rem; color: var(--accent-cyan); margin-bottom: 0.5rem; display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; }
        .text-history-content { font-size: 0.8rem; color: var(--text-secondary); display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        .toast { position: fixed; bottom: 2rem; right: 2rem; background: var(--bg-card); border: 1px solid var(--accent-cyan); padding: 1rem 1.5rem; border-radius: 12px; display: flex; align-items: center; gap: 0.8rem; transform: translateY(100px); opacity: 0; transition: all 0.3s; z-index: 1000; }
        .toast.show { transform: translateY(0); opacity: 1; }
        .toast.success { border-color: var(--accent-green); }
        .toast.error { border-color: #ff4444; }
        .toast.info { border-color: var(--accent-orange); }
        .panel { display: none; }
        .panel.active { display: block; }
        
        /* Video specific styles */
        .video-info { font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem; padding: 0.5rem; background: var(--glass); border-radius: 8px; }
        .video-info span { color: var(--accent-orange); }
        .progress-bar { width: 100%; height: 6px; background: var(--glass); border-radius: 3px; overflow: hidden; margin-top: 1rem; display: none; }
        .progress-bar.active { display: block; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent-cyan), var(--accent-magenta), var(--accent-orange)); width: 0%; transition: width 0.3s; animation: progressGlow 2s ease-in-out infinite; }
        @keyframes progressGlow { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        
        @media (max-width: 1100px) { .main-grid { grid-template-columns: 1fr; } .model-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) { 
            header { padding: 1rem 1.5rem; flex-direction: column; gap: 1rem; } 
            .container { padding: 1rem 1.5rem 2rem; } 
            .hero h1 { font-size: 2rem; } 
            .logo { font-size: 1.4rem; } 
            .model-grid { grid-template-columns: 1fr; } 
            .mode-tab { padding: 0.6rem 0.8rem; font-size: 0.7rem; } 
            .mode-tabs { flex-wrap: wrap; justify-content: center; }
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-secondary); }
        ::-webkit-scrollbar-thumb { background: linear-gradient(var(--accent-cyan), var(--accent-magenta)); border-radius: 4px; }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    <div class="particles" id="particles"></div>
    <header>
        <div>
            <div class="logo">å¹»å¢ƒé€ ç‰©</div>
            <div class="logo-sub">DREAMFORGE AI</div>
        </div>
        <div class="mode-tabs">
            <button class="mode-tab active" data-mode="image"><span>ğŸ¨</span> æ–‡ç”Ÿå›¾</button>
            <button class="mode-tab" data-mode="video"><span>ğŸ¬</span> æ–‡ç”Ÿè§†é¢‘</button>
            <button class="mode-tab" data-mode="text"><span>âœï¸</span> æ–‡ç”Ÿæ–‡</button>
        </div>
    </header>
    <main class="container">
        <section class="hero">
            <h1 id="heroTitle">AI å›¾åƒåˆ›é€ å¼•æ“</h1>
            <p id="heroDesc">è¾“å…¥æ–‡å­—æè¿°ï¼Œè®© AI ä¸ºä½ ç»˜åˆ¶æ¢¦å¢ƒã€‚æ”¯æŒå¤šç§å¼€æºæ¨¡å‹ï¼Œé‡Šæ”¾æ— é™åˆ›æ„ã€‚</p>
        </section>
        <div class="main-grid">
            <!-- Image Panel -->
            <div class="panel active" id="imagePanel">
                <div class="glass-card">
                    <div class="card-title">å›¾åƒæ¨¡å‹</div>
                    <div class="model-grid" id="imageModelGrid">
                        <div class="model-option active" data-model="flux"><div class="model-name">ğŸ¨ Flux</div><div class="model-desc">é«˜è´¨é‡é€šç”¨æ¨¡å‹</div><span class="model-badge badge-quality">æ¨è</span></div>
                        <div class="model-option" data-model="flux-realism"><div class="model-name">ğŸ“· Flux Realism</div><div class="model-desc">ç…§ç‰‡çº§çœŸå®æ„Ÿ</div></div>
                        <div class="model-option" data-model="flux-anime"><div class="model-name">âœ¨ Flux Anime</div><div class="model-desc">åŠ¨æ¼«é£æ ¼ä¸“ç²¾</div></div>
                        <div class="model-option" data-model="flux-3d"><div class="model-name">ğŸ® Flux 3D</div><div class="model-desc">3D æ¸²æŸ“æ•ˆæœ</div></div>
                        <div class="model-option" data-model="flux-cablyai"><div class="model-name">ğŸŒŸ CablyAI</div><div class="model-desc">åˆ›æ„è‰ºæœ¯é£æ ¼</div><span class="model-badge badge-creative">åˆ›æ„</span></div>
                        <div class="model-option" data-model="turbo"><div class="model-name">âš¡ Turbo</div><div class="model-desc">æé€Ÿç”Ÿæˆæ¨¡å¼</div><span class="model-badge badge-fast">å¿«é€Ÿ</span></div>
                    </div>
                    <div class="card-title magenta">åˆ›æ„æè¿°</div>
                    <div class="prompt-section">
                        <textarea class="prompt-textarea" id="imagePrompt" placeholder="æè¿°ä½ æƒ³è¦ç”Ÿæˆçš„å›¾åƒ...&#10;&#10;ä¾‹å¦‚ï¼šä¸€åªç©¿ç€å¤ªç©ºæœçš„çŒ«å’ªåœ¨æœˆçƒä¸Šæ¼«æ­¥ï¼ŒèƒŒæ™¯æ˜¯è”šè“çš„åœ°çƒï¼Œç”µå½±çº§å…‰å½±ï¼Œ8Kè¶…é«˜æ¸…"></textarea>
                    </div>
                    <div class="card-title green">å›¾åƒå°ºå¯¸</div>
                    <div class="size-options">
                        <button class="size-btn active" data-size="1024x1024">1:1 æ­£æ–¹å½¢</button>
                        <button class="size-btn" data-size="1024x768">4:3 æ¨ªç‰ˆ</button>
                        <button class="size-btn" data-size="768x1024">3:4 ç«–ç‰ˆ</button>
                        <button class="size-btn" data-size="1280x720">16:9 å®½å±</button>
                    </div>
                    <button class="generate-btn" id="imageGenerateBtn">âœ¨ å¼€å§‹ç”Ÿæˆ</button>
                </div>
            </div>
            
            <!-- Video Panel -->
            <div class="panel" id="videoPanel">
                <div class="glass-card">
                    <div class="card-title orange">æ™ºè°± CogVideoX-Flash</div>
                    <div class="model-grid video-models" id="videoModelGrid">
                        <div class="model-option active" data-model="cogvideox-flash"><div class="model-name">ğŸ¬ CogVideoX-Flash</div><div class="model-desc">æ™ºè°±AIå…è´¹è§†é¢‘æ¨¡å‹</div><span class="model-badge badge-free">å…è´¹</span></div>
                        <div class="model-option" data-model="speed"><div class="model-name">âš¡ é€Ÿåº¦ä¼˜å…ˆ</div><div class="model-desc">æ›´å¿«ç”Ÿæˆé€Ÿåº¦</div><span class="model-badge badge-fast">å¿«é€Ÿ</span></div>
                    </div>
                    
                    <div class="card-title magenta">è§†é¢‘æè¿°</div>
                    <div class="prompt-section">
                        <textarea class="prompt-textarea" id="videoPrompt" placeholder="æè¿°ä½ æƒ³è¦ç”Ÿæˆçš„è§†é¢‘å†…å®¹...&#10;&#10;ä¾‹å¦‚ï¼šä¸€æœµç«ç‘°èŠ±åœ¨é˜³å…‰ä¸‹ç¼“ç¼“ç»½æ”¾ï¼ŒèŠ±ç“£ä¸Šæœ‰éœ²ç é—ªçƒï¼Œå¾®é£è½»æ‹‚ï¼Œç”µå½±çº§ç”»è´¨"></textarea>
                    </div>
                    <div class="video-info">
                        ğŸ’¡ æç¤ºï¼šè§†é¢‘ç”Ÿæˆéœ€è¦ <span>60-180ç§’</span>ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚CogVideoX-Flash æ”¯æŒæœ€é«˜1080Påˆ†è¾¨ç‡ï¼Œç”Ÿæˆçº¦6ç§’è§†é¢‘ã€‚
                    </div>
                    <button class="generate-btn video-btn" id="videoGenerateBtn">ğŸ¬ ç”Ÿæˆè§†é¢‘</button>
                    <div class="progress-bar" id="videoProgress">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
            </div>
            
            <!-- Text Panel -->
            <div class="panel" id="textPanel">
                <div class="glass-card">
                    <div class="card-title">è¯­è¨€æ¨¡å‹</div>
                    <div class="model-grid text-models" id="textModelGrid">
                        <div class="model-option active" data-model="openai"><div class="model-name">ğŸ¤– OpenAI GPT</div><div class="model-desc">å¼ºå¤§é€šç”¨æ¨¡å‹</div><span class="model-badge badge-quality">æ¨è</span></div>
                        <div class="model-option" data-model="deepseek"><div class="model-name">ğŸ”® DeepSeek</div><div class="model-desc">æ·±åº¦æ€è€ƒæ¨ç†</div><span class="model-badge badge-smart">æ™ºèƒ½</span></div>
                        <div class="model-option" data-model="qwen"><div class="model-name">ğŸŒ Qwen é€šä¹‰</div><div class="model-desc">é˜¿é‡Œé€šä¹‰åƒé—®</div></div>
                        <div class="model-option" data-model="mistral"><div class="model-name">ğŸŒ€ Mistral</div><div class="model-desc">é«˜æ•ˆæ³•å›½æ¨¡å‹</div><span class="model-badge badge-fast">å¿«é€Ÿ</span></div>
                        <div class="model-option" data-model="llama"><div class="model-name">ğŸ¦™ Llama</div><div class="model-desc">Metaå¼€æºå¤§æ¨¡å‹</div></div>
                        <div class="model-option" data-model="gemini"><div class="model-name">ğŸ’ Gemini</div><div class="model-desc">Google AIæ¨¡å‹</div><span class="model-badge badge-creative">åˆ›æ„</span></div>
                    </div>
                    <div class="card-title magenta">è¾“å…¥æç¤º</div>
                    <div class="prompt-section">
                        <textarea class="prompt-textarea" id="textPrompt" placeholder="è¾“å…¥ä½ çš„é—®é¢˜æˆ–åˆ›ä½œéœ€æ±‚...&#10;&#10;ä¾‹å¦‚ï¼šå†™ä¸€é¦–å…³äºæ˜¥å¤©çš„è¯—ï¼Œè¦æœ‰æ±Ÿå—æ°´ä¹¡çš„æ„å¢ƒ"></textarea>
                    </div>
                    <button class="generate-btn" id="textGenerateBtn">âœ¨ å¼€å§‹ç”Ÿæˆ</button>
                </div>
            </div>
            
            <!-- Preview Area -->
            <div class="glass-card">
                <div class="card-title" id="previewTitle">ç”Ÿæˆé¢„è§ˆ</div>
                <div class="preview-area" id="previewArea">
                    <div class="preview-placeholder" id="placeholder">
                        <div class="icon" id="placeholderIcon">ğŸ¨</div>
                        <p id="placeholderText">è¾“å…¥æè¿°å¹¶ç‚¹å‡»ç”Ÿæˆ<br>è®© AI ä¸ºä½ åˆ›ä½œ</p>
                    </div>
                    <div class="loading-container" id="loading">
                        <div class="cyber-loader"><div class="ring"></div><div class="ring"></div><div class="ring"></div><div class="core"></div></div>
                        <div class="loading-text" id="loadingText">AI æ­£åœ¨åˆ›ä½œä¸­...</div>
                    </div>
                    <img class="preview-image" id="previewImage" style="display: none;" alt="Generated Image">
                    <video class="preview-video" id="previewVideo" style="display: none;" controls loop autoplay muted></video>
                    <div class="text-output" id="textOutput"></div>
                    <div class="action-buttons" id="imageActions">
                        <button class="action-btn download-btn" id="downloadBtn"><span>ğŸ“¥</span> ä¸‹è½½å›¾åƒ</button>
                        <button class="action-btn share-btn" id="newTabBtn"><span>ğŸ”—</span> æ–°çª—å£æ‰“å¼€</button>
                    </div>
                    <div class="action-buttons" id="videoActions">
                        <button class="action-btn video-download-btn" id="downloadVideoBtn"><span>ğŸ“¥</span> ä¸‹è½½è§†é¢‘</button>
                        <button class="action-btn share-btn" id="newTabVideoBtn"><span>ğŸ”—</span> æ–°çª—å£æ‰“å¼€</button>
                    </div>
                    <div class="action-buttons" id="textActions">
                        <button class="action-btn copy-btn" id="copyBtn"><span>ğŸ“‹</span> å¤åˆ¶æ–‡æœ¬</button>
                        <button class="action-btn download-btn" id="downloadTextBtn"><span>ğŸ“¥</span> ä¸‹è½½æ–‡æœ¬</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- History Sections -->
        <section class="history-section glass-card" id="imageHistorySection" style="display: none;">
            <div class="card-title">å›¾åƒå†å²</div>
            <div class="history-grid" id="imageHistoryGrid"></div>
        </section>
        <section class="history-section glass-card" id="videoHistorySection" style="display: none;">
            <div class="card-title orange">è§†é¢‘å†å²</div>
            <div class="history-grid" id="videoHistoryGrid"></div>
        </section>
        <section class="history-section glass-card" id="textHistorySection" style="display: none;">
            <div class="card-title">å¯¹è¯å†å²</div>
            <div class="history-grid" id="textHistoryGrid" style="grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));"></div>
        </section>
    </main>
    <div class="toast" id="toast"></div>
    
    <script>
        // Create particles
        const particlesContainer = document.getElementById('particles');
        for (let i = 0; i < 25; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDuration = (10 + Math.random() * 20) + 's';
            particle.style.animationDelay = Math.random() * 15 + 's';
            particlesContainer.appendChild(particle);
        }

        // State
        let currentMode = 'image';
        let selectedImageModel = 'flux';
        let selectedVideoModel = 'cogvideox-flash';
        let selectedTextModel = 'openai';
        let selectedSize = '1024x1024';
        let currentImageUrl = '';
        let currentVideoUrl = '';
        let currentTextContent = '';
        let imageHistory = [];
        let videoHistory = [];
        let textHistory = [];

        // DOM Elements
        const modeTabs = document.querySelectorAll('.mode-tab');
        const imagePanel = document.getElementById('imagePanel');
        const videoPanel = document.getElementById('videoPanel');
        const textPanel = document.getElementById('textPanel');
        const heroTitle = document.getElementById('heroTitle');
        const heroDesc = document.getElementById('heroDesc');
        const placeholderIcon = document.getElementById('placeholderIcon');
        const placeholderText = document.getElementById('placeholderText');
        const imageModelOptions = document.querySelectorAll('#imageModelGrid .model-option');
        const videoModelOptions = document.querySelectorAll('#videoModelGrid .model-option');
        const textModelOptions = document.querySelectorAll('#textModelGrid .model-option');
        const sizeButtons = document.querySelectorAll('.size-btn');
        const imagePrompt = document.getElementById('imagePrompt');
        const videoPrompt = document.getElementById('videoPrompt');
        const textPrompt = document.getElementById('textPrompt');
        const ZHIPU_API_KEY = '00b08fee86f84b33a353f45b0b0f6c0f.tBYJiYISieVqrTjA';
        const imageGenerateBtn = document.getElementById('imageGenerateBtn');
        const videoGenerateBtn = document.getElementById('videoGenerateBtn');
        const textGenerateBtn = document.getElementById('textGenerateBtn');
        const placeholder = document.getElementById('placeholder');
        const loading = document.getElementById('loading');
        const loadingText = document.getElementById('loadingText');
        const previewImage = document.getElementById('previewImage');
        const previewVideo = document.getElementById('previewVideo');
        const textOutput = document.getElementById('textOutput');
        const imageActions = document.getElementById('imageActions');
        const videoActions = document.getElementById('videoActions');
        const textActions = document.getElementById('textActions');
        const imageHistorySection = document.getElementById('imageHistorySection');
        const videoHistorySection = document.getElementById('videoHistorySection');
        const textHistorySection = document.getElementById('textHistorySection');
        const imageHistoryGrid = document.getElementById('imageHistoryGrid');
        const videoHistoryGrid = document.getElementById('videoHistoryGrid');
        const textHistoryGrid = document.getElementById('textHistoryGrid');
        const videoProgress = document.getElementById('videoProgress');
        const progressFill = document.getElementById('progressFill');

        // Mode Switching
        modeTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const mode = tab.dataset.mode;
                if (mode === currentMode) return;
                modeTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentMode = mode;
                
                // Hide all panels
                imagePanel.classList.remove('active');
                videoPanel.classList.remove('active');
                textPanel.classList.remove('active');
                
                // Hide all history sections
                imageHistorySection.style.display = 'none';
                videoHistorySection.style.display = 'none';
                textHistorySection.style.display = 'none';
                
                if (mode === 'image') {
                    imagePanel.classList.add('active');
                    heroTitle.textContent = 'AI å›¾åƒåˆ›é€ å¼•æ“';
                    heroDesc.textContent = 'è¾“å…¥æ–‡å­—æè¿°ï¼Œè®© AI ä¸ºä½ ç»˜åˆ¶æ¢¦å¢ƒã€‚æ”¯æŒå¤šç§å¼€æºæ¨¡å‹ï¼Œé‡Šæ”¾æ— é™åˆ›æ„ã€‚';
                    placeholderIcon.textContent = 'ğŸ¨';
                    placeholderText.innerHTML = 'è¾“å…¥æè¿°å¹¶ç‚¹å‡»ç”Ÿæˆ<br>è®© AI ä¸ºä½ åˆ›ä½œå›¾åƒ';
                    imageHistorySection.style.display = imageHistory.length ? 'block' : 'none';
                } else if (mode === 'video') {
                    videoPanel.classList.add('active');
                    heroTitle.textContent = 'AI è§†é¢‘åˆ›é€ å¼•æ“';
                    heroDesc.textContent = 'åŸºäºæ™ºè°± CogVideoX-Flash å…è´¹æ¨¡å‹ï¼Œè¾“å…¥æè¿°ç”Ÿæˆé«˜è´¨é‡è§†é¢‘ã€‚';
                    placeholderIcon.textContent = 'ğŸ¬';
                    placeholderText.innerHTML = 'è¾“å…¥æè¿°å¹¶ç‚¹å‡»ç”Ÿæˆ<br>è®© AI ä¸ºä½ åˆ›ä½œè§†é¢‘';
                    videoHistorySection.style.display = videoHistory.length ? 'block' : 'none';
                } else {
                    textPanel.classList.add('active');
                    heroTitle.textContent = 'AI æ–‡å­—åˆ›ä½œå¼•æ“';
                    heroDesc.textContent = 'ä¸é¡¶å°– AI å¯¹è¯ï¼Œè·å–åˆ›æ„çµæ„Ÿã€çŸ¥è¯†è§£ç­”ã€æ–‡æ¡ˆæ’°å†™ã€‚';
                    placeholderIcon.textContent = 'âœï¸';
                    placeholderText.innerHTML = 'è¾“å…¥æç¤ºå¹¶ç‚¹å‡»ç”Ÿæˆ<br>è®© AI ä¸ºä½ åˆ›ä½œæ–‡å­—';
                    textHistorySection.style.display = textHistory.length ? 'block' : 'none';
                }
                
                placeholder.style.display = 'block';
                previewImage.style.display = 'none';
                previewVideo.style.display = 'none';
                textOutput.classList.remove('visible');
                imageActions.classList.remove('visible');
                videoActions.classList.remove('visible');
                textActions.classList.remove('visible');
            });
        });

        // Model Selection
        imageModelOptions.forEach(option => {
            option.addEventListener('click', () => {
                imageModelOptions.forEach(o => o.classList.remove('active'));
                option.classList.add('active');
                selectedImageModel = option.dataset.model;
            });
        });
        videoModelOptions.forEach(option => {
            option.addEventListener('click', () => {
                videoModelOptions.forEach(o => o.classList.remove('active'));
                option.classList.add('active');
                selectedVideoModel = option.dataset.model;
            });
        });
        textModelOptions.forEach(option => {
            option.addEventListener('click', () => {
                textModelOptions.forEach(o => o.classList.remove('active'));
                option.classList.add('active');
                selectedTextModel = option.dataset.model;
            });
        });
        sizeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                sizeButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedSize = btn.dataset.size;
            });
        });

        // Generate Image
        imageGenerateBtn.addEventListener('click', async () => {
            const prompt = imagePrompt.value.trim();
            if (!prompt) { showToast('è¯·è¾“å…¥å›¾åƒæè¿°', 'error'); return; }
            placeholder.style.display = 'none';
            previewImage.style.display = 'none';
            previewVideo.style.display = 'none';
            textOutput.classList.remove('visible');
            imageActions.classList.remove('visible');
            videoActions.classList.remove('visible');
            textActions.classList.remove('visible');
            loading.classList.add('active');
            loadingText.textContent = 'AI æ­£åœ¨ç»˜åˆ¶ä¸­...';
            imageGenerateBtn.disabled = true;
            imageGenerateBtn.textContent = 'â³ ç”Ÿæˆä¸­...';
            try {
                const [width, height] = selectedSize.split('x');
                const seed = Math.floor(Math.random() * 1000000);
                const imageUrl = `https://image.pollinations.ai/prompt/${encodeURIComponent(prompt)}?model=${selectedImageModel}&width=${width}&height=${height}&seed=${seed}&nologo=true`;
                const img = new Image();
                img.crossOrigin = 'anonymous';
                img.onload = () => {
                    currentImageUrl = imageUrl;
                    previewImage.src = imageUrl;
                    loading.classList.remove('active');
                    previewImage.style.display = 'block';
                    imageActions.classList.add('visible');
                    imageGenerateBtn.disabled = false;
                    imageGenerateBtn.textContent = 'âœ¨ å¼€å§‹ç”Ÿæˆ';
                    addToImageHistory(imageUrl, prompt);
                    showToast('å›¾åƒç”ŸæˆæˆåŠŸï¼', 'success');
                };
                img.onerror = () => { throw new Error('å›¾åƒåŠ è½½å¤±è´¥'); };
                img.src = imageUrl;
            } catch (error) {
                loading.classList.remove('active');
                placeholder.style.display = 'block';
                imageGenerateBtn.disabled = false;
                imageGenerateBtn.textContent = 'âœ¨ å¼€å§‹ç”Ÿæˆ';
                showToast('ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            }
        });

        // Generate Video using æ™ºè°± CogVideoX-Flash API
        videoGenerateBtn.addEventListener('click', async () => {
            const prompt = videoPrompt.value.trim();
            
            if (!prompt) { 
                showToast('è¯·è¾“å…¥è§†é¢‘æè¿°', 'error'); 
                return; 
            }
            
            placeholder.style.display = 'none';
            previewImage.style.display = 'none';
            previewVideo.style.display = 'none';
            textOutput.classList.remove('visible');
            imageActions.classList.remove('visible');
            videoActions.classList.remove('visible');
            textActions.classList.remove('visible');
            loading.classList.add('active');
            loadingText.textContent = 'AI æ­£åœ¨ç”Ÿæˆè§†é¢‘...';
            videoGenerateBtn.disabled = true;
            videoGenerateBtn.textContent = 'â³ æäº¤ä»»åŠ¡...';
            
            // Show progress bar
            videoProgress.classList.add('active');
            progressFill.style.width = '10%';
            
            try {
                // Step 1: Create video generation task
                const quality = selectedVideoModel === 'speed' ? 'speed' : 'quality';
                
                const createResponse = await fetch('https://open.bigmodel.cn/api/paas/v4/videos/generations', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${ZHIPU_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'cogvideox-flash',
                        prompt: prompt,
                        quality: quality
                    })
                });
                
                if (!createResponse.ok) {
                    const errorData = await createResponse.json().catch(() => ({}));
                    throw new Error(errorData.error?.message || `APIè¯·æ±‚å¤±è´¥: ${createResponse.status}`);
                }
                
                const createData = await createResponse.json();
                const taskId = createData.id;
                
                if (!taskId) {
                    throw new Error('æœªè·å–åˆ°ä»»åŠ¡ID');
                }
                
                showToast('è§†é¢‘ä»»åŠ¡å·²æäº¤ï¼Œæ­£åœ¨ç”Ÿæˆä¸­...', 'info');
                progressFill.style.width = '20%';
                videoGenerateBtn.textContent = 'â³ ç”Ÿæˆä¸­...';
                loadingText.textContent = 'è§†é¢‘ç”Ÿæˆä¸­ï¼Œè¯·è€å¿ƒç­‰å¾…...';
                
                // Step 2: Poll for result
                let attempts = 0;
                const maxAttempts = 60; // Max 5 minutes (60 * 5 seconds)
                let videoUrl = null;
                
                while (attempts < maxAttempts) {
                    await new Promise(resolve => setTimeout(resolve, 5000)); // Wait 5 seconds
                    
                    const statusResponse = await fetch(`https://open.bigmodel.cn/api/paas/v4/async-result/${taskId}`, {
                        method: 'GET',
                        headers: {
                            'Authorization': `Bearer ${ZHIPU_API_KEY}`
                        }
                    });
                    
                    if (!statusResponse.ok) {
                        attempts++;
                        continue;
                    }
                    
                    const statusData = await statusResponse.json();
                    const taskStatus = statusData.task_status;
                    
                    // Update progress
                    const progress = Math.min(20 + (attempts / maxAttempts) * 70, 90);
                    progressFill.style.width = progress + '%';
                    loadingText.textContent = `è§†é¢‘ç”Ÿæˆä¸­ (${Math.round(progress)}%)...`;
                    
                    if (taskStatus === 'SUCCESS') {
                        if (statusData.video_result && statusData.video_result.length > 0) {
                            videoUrl = statusData.video_result[0].url;
                        }
                        break;
                    } else if (taskStatus === 'FAIL') {
                        throw new Error('è§†é¢‘ç”Ÿæˆå¤±è´¥');
                    }
                    
                    attempts++;
                }
                
                if (!videoUrl) {
                    throw new Error('è§†é¢‘ç”Ÿæˆè¶…æ—¶ï¼Œè¯·ç¨åé‡è¯•');
                }
                
                progressFill.style.width = '100%';
                
                // Display video
                setTimeout(() => {
                    currentVideoUrl = videoUrl;
                    previewVideo.src = videoUrl;
                    loading.classList.remove('active');
                    videoProgress.classList.remove('active');
                    progressFill.style.width = '0%';
                    previewVideo.style.display = 'block';
                    videoActions.classList.add('visible');
                    videoGenerateBtn.disabled = false;
                    videoGenerateBtn.textContent = 'ğŸ¬ ç”Ÿæˆè§†é¢‘';
                    addToVideoHistory(videoUrl, prompt);
                    showToast('è§†é¢‘ç”ŸæˆæˆåŠŸï¼', 'success');
                }, 500);
                
            } catch (error) {
                console.error('Video generation error:', error);
                loading.classList.remove('active');
                videoProgress.classList.remove('active');
                progressFill.style.width = '0%';
                placeholder.style.display = 'block';
                videoGenerateBtn.disabled = false;
                videoGenerateBtn.textContent = 'ğŸ¬ ç”Ÿæˆè§†é¢‘';
                showToast('è§†é¢‘ç”Ÿæˆå¤±è´¥: ' + error.message, 'error');
            }
        });

        // Generate Text
        textGenerateBtn.addEventListener('click', async () => {
            const prompt = textPrompt.value.trim();
            if (!prompt) { showToast('è¯·è¾“å…¥æç¤ºå†…å®¹', 'error'); return; }
            placeholder.style.display = 'none';
            previewImage.style.display = 'none';
            previewVideo.style.display = 'none';
            textOutput.classList.remove('visible');
            imageActions.classList.remove('visible');
            videoActions.classList.remove('visible');
            textActions.classList.remove('visible');
            loading.classList.add('active');
            loadingText.textContent = 'AI æ­£åœ¨æ€è€ƒä¸­...';
            textGenerateBtn.disabled = true;
            textGenerateBtn.textContent = 'â³ ç”Ÿæˆä¸­...';
            try {
                const response = await fetch('https://text.pollinations.ai/openai', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: selectedTextModel,
                        messages: [
                            { role: 'system', content: 'ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„AIåŠ©æ‰‹ï¼Œè¯·ç”¨ä¸­æ–‡å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚å›ç­”è¦è¯¦ç»†ã€æœ‰æ¡ç†ã€‚' },
                            { role: 'user', content: prompt }
                        ],
                        temperature: 0.7
                    })
                });
                if (!response.ok) throw new Error('APIè¯·æ±‚å¤±è´¥: ' + response.status);
                const data = await response.json();
                const text = data.choices?.[0]?.message?.content || 'ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•';
                currentTextContent = text;
                loading.classList.remove('active');
                textOutput.innerHTML = '';
                textOutput.classList.add('visible');
                await typeText(text, textOutput);
                textActions.classList.add('visible');
                textGenerateBtn.disabled = false;
                textGenerateBtn.textContent = 'âœ¨ å¼€å§‹ç”Ÿæˆ';
                addToTextHistory(prompt, text);
                showToast('æ–‡æœ¬ç”ŸæˆæˆåŠŸï¼', 'success');
            } catch (error) {
                console.error('Text generation error:', error);
                loading.classList.remove('active');
                placeholder.style.display = 'block';
                textGenerateBtn.disabled = false;
                textGenerateBtn.textContent = 'âœ¨ å¼€å§‹ç”Ÿæˆ';
                showToast('ç”Ÿæˆå¤±è´¥: ' + error.message, 'error');
            }
        });

        // Typing effect
        async function typeText(text, element) {
            const cursor = document.createElement('span');
            cursor.className = 'typing-cursor';
            element.appendChild(cursor);
            const chars = text.split('');
            let i = 0;
            return new Promise(resolve => {
                function type() {
                    if (i < chars.length) {
                        cursor.before(document.createTextNode(chars[i]));
                        i++;
                        setTimeout(type, 12);
                    } else {
                        cursor.remove();
                        resolve();
                    }
                }
                type();
            });
        }

        // Download Image
        document.getElementById('downloadBtn').addEventListener('click', async () => {
            if (!currentImageUrl) return;
            try {
                showToast('æ­£åœ¨å‡†å¤‡ä¸‹è½½...', 'success');
                const response = await fetch(currentImageUrl);
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'dreamforge_' + Date.now() + '.png';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                showToast('ä¸‹è½½æˆåŠŸï¼', 'success');
            } catch (error) { showToast('ä¸‹è½½å¤±è´¥ï¼Œè¯·å°è¯•å³é”®ä¿å­˜', 'error'); }
        });

        // Download Video
        document.getElementById('downloadVideoBtn').addEventListener('click', async () => {
            if (!currentVideoUrl) return;
            try {
                showToast('æ­£åœ¨å‡†å¤‡ä¸‹è½½...', 'success');
                const a = document.createElement('a');
                a.href = currentVideoUrl;
                a.download = 'dreamforge_video_' + Date.now() + '.mp4';
                a.target = '_blank';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                showToast('ä¸‹è½½æˆåŠŸï¼', 'success');
            } catch (error) { 
                showToast('ä¸‹è½½å¤±è´¥ï¼Œè¯·å°è¯•å³é”®ä¿å­˜', 'error'); 
            }
        });

        document.getElementById('newTabBtn').addEventListener('click', () => {
            if (currentImageUrl) window.open(currentImageUrl, '_blank');
        });

        document.getElementById('newTabVideoBtn').addEventListener('click', () => {
            if (currentVideoUrl) window.open(currentVideoUrl, '_blank');
        });

        document.getElementById('copyBtn').addEventListener('click', async () => {
            if (!currentTextContent) return;
            try {
                await navigator.clipboard.writeText(currentTextContent);
                showToast('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼', 'success');
            } catch (error) { showToast('å¤åˆ¶å¤±è´¥', 'error'); }
        });

        document.getElementById('downloadTextBtn').addEventListener('click', () => {
            if (!currentTextContent) return;
            const blob = new Blob([currentTextContent], { type: 'text/plain;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'dreamforge_text_' + Date.now() + '.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            showToast('ä¸‹è½½æˆåŠŸï¼', 'success');
        });

        // History functions
        function addToImageHistory(url, prompt) {
            imageHistory.unshift({ url, prompt, timestamp: Date.now() });
            if (imageHistory.length > 12) imageHistory.pop();
            renderImageHistory();
        }
        
        function addToVideoHistory(url, prompt) {
            videoHistory.unshift({ url, prompt, timestamp: Date.now() });
            if (videoHistory.length > 8) videoHistory.pop();
            renderVideoHistory();
        }
        
        function addToTextHistory(prompt, content) {
            textHistory.unshift({ prompt, content, timestamp: Date.now() });
            if (textHistory.length > 8) textHistory.pop();
            renderTextHistory();
        }
        
        function renderImageHistory() {
            if (imageHistory.length === 0) { imageHistorySection.style.display = 'none'; return; }
            if (currentMode === 'image') imageHistorySection.style.display = 'block';
            imageHistoryGrid.innerHTML = imageHistory.map(item => 
                '<div class="history-item" onclick="loadImageHistory(\'' + item.url + '\', \'' + item.prompt.replace(/'/g, "\\'").replace(/\n/g, " ") + '\')"><img src="' + item.url + '" alt="History"><div class="overlay"><span class="prompt-preview">' + item.prompt + '</span></div></div>'
            ).join('');
        }
        
        function renderVideoHistory() {
            if (videoHistory.length === 0) { videoHistorySection.style.display = 'none'; return; }
            if (currentMode === 'video') videoHistorySection.style.display = 'block';
            videoHistoryGrid.innerHTML = videoHistory.map((item, idx) => 
                '<div class="history-item" onclick="loadVideoHistory(' + idx + ')"><video src="' + item.url + '" muted></video><span class="video-badge">ğŸ¬ è§†é¢‘</span><div class="overlay"><span class="prompt-preview">' + item.prompt + '</span></div></div>'
            ).join('');
        }
        
        function renderTextHistory() {
            if (textHistory.length === 0) { textHistorySection.style.display = 'none'; return; }
            if (currentMode === 'text') textHistorySection.style.display = 'block';
            textHistoryGrid.innerHTML = textHistory.map((item, idx) => 
                '<div class="text-history-item" onclick="loadTextHistory(' + idx + ')"><div class="text-history-prompt">ğŸ’¬ ' + item.prompt + '</div><div class="text-history-content">' + item.content + '</div></div>'
            ).join('');
        }
        
        window.loadImageHistory = function(url, prompt) {
            currentImageUrl = url;
            previewImage.src = url;
            placeholder.style.display = 'none';
            previewVideo.style.display = 'none';
            textOutput.classList.remove('visible');
            previewImage.style.display = 'block';
            imageActions.classList.add('visible');
            videoActions.classList.remove('visible');
            textActions.classList.remove('visible');
            imagePrompt.value = prompt;
        };
        
        window.loadVideoHistory = function(idx) {
            const item = videoHistory[idx];
            currentVideoUrl = item.url;
            previewVideo.src = item.url;
            placeholder.style.display = 'none';
            previewImage.style.display = 'none';
            textOutput.classList.remove('visible');
            previewVideo.style.display = 'block';
            videoActions.classList.add('visible');
            imageActions.classList.remove('visible');
            textActions.classList.remove('visible');
            videoPrompt.value = item.prompt;
        };
        
        window.loadTextHistory = function(idx) {
            const item = textHistory[idx];
            currentTextContent = item.content;
            textPrompt.value = item.prompt;
            placeholder.style.display = 'none';
            previewImage.style.display = 'none';
            previewVideo.style.display = 'none';
            textOutput.textContent = item.content;
            textOutput.classList.add('visible');
            textActions.classList.add('visible');
            imageActions.classList.remove('visible');
            videoActions.classList.remove('visible');
        };

        // Toast
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.className = 'toast ' + type;
            const icon = type === 'success' ? 'âœ“' : type === 'error' ? 'âœ•' : 'â„¹';
            toast.innerHTML = '<span>' + icon + '</span><span>' + message + '</span>';
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // Keyboard shortcuts
        imagePrompt.addEventListener('keydown', (e) => { if (e.key === 'Enter' && e.ctrlKey) imageGenerateBtn.click(); });
        videoPrompt.addEventListener('keydown', (e) => { if (e.key === 'Enter' && e.ctrlKey) videoGenerateBtn.click(); });
        textPrompt.addEventListener('keydown', (e) => { if (e.key === 'Enter' && e.ctrlKey) textGenerateBtn.click(); });
    </script>
</body>
</html>
